Search.setIndex({"alltitles": {"Advanced Operations": [[18, null]], "Arguments": [[4, "arguments"], [5, "arguments"], [6, "arguments"], [8, "arguments"], [9, "arguments"], [10, "arguments"], [11, "arguments"], [12, "arguments"], [13, "arguments"], [14, "arguments"]], "Arguments:": [[3, "arguments"], [7, "arguments"]], "Automated Hyperparameter Tuning": [[17, "automated-hyperparameter-tuning"]], "Basic Operation": [[18, null]], "Contribute to GPI": [[16, "contribute-to-gpi"]], "Creating Texts": [[14, "creating-texts"]], "Customizing Your Analysis": [[0, null]], "Data Generation": [[18, null]], "Estimation Workflow": [[0, "estimation-workflow"]], "Example Usage": [[1, "example-usage"], [2, "example-usage"], [3, "example-usage"], [5, "example-usage"], [6, "example-usage"], [8, "example-usage"], [9, "example-usage"], [10, "example-usage"], [11, "example-usage"], [12, "example-usage"], [13, "example-usage"]], "Example Usage:": [[4, "example-usage"], [7, "example-usage"]], "Example: Gemma2": [[15, "example-gemma2"]], "From PyPI": [[19, "from-pypi"]], "From Source": [[19, "from-source"]], "GPI: Generative-AI Powered Inference": [[18, null]], "Generating Texts with LLaMa3": [[14, null]], "Generating Texts with Other LLMs": [[15, null]], "Generative-AI Powered Inference": [[16, "generative-ai-powered-inference"]], "Getting Started": [[18, null]], "Google Colaboratory": [[21, "id1"]], "How to control confounders": [[22, "how-to-control-confounders"]], "How to estimate treatment effects": [[22, "how-to-estimate-treatment-effects"]], "How to use GPU": [[21, null]], "How to use LLaMa3": [[14, "how-to-use-llama3"]], "Hyperparameter Tuning": [[17, null]], "Hyperparameters": [[22, "hyperparameters"]], "Installation": [[19, null]], "List of Hyperparameters": [[17, "list-of-hyperparameters"]], "Methods": [[1, "methods"], [2, "methods"]], "Model Quantization": [[20, "model-quantization"]], "Parameters": [[1, "parameters"], [2, "parameters"], [3, "parameters"]], "Propensity Score Model": [[0, "propensity-score-model"]], "Purpose and Description": [[1, "purpose-and-description"], [2, "purpose-and-description"], [3, "purpose-and-description"], [5, "purpose-and-description"], [6, "purpose-and-description"], [8, "purpose-and-description"], [9, "purpose-and-description"], [10, "purpose-and-description"], [11, "purpose-and-description"], [12, "purpose-and-description"], [13, "purpose-and-description"]], "Purpose and Description:": [[4, "purpose-and-description"], [7, "purpose-and-description"]], "References": [[16, "references"], [18, null]], "Repeating Texts": [[14, "repeating-texts"]], "Requirements": [[19, "requirements"]], "Returns": [[5, "returns"], [6, "returns"], [8, "returns"], [9, "returns"], [10, "returns"], [11, "returns"], [12, "returns"], [13, "returns"]], "Returns:": [[7, "returns"]], "SpectralNormClassifier": [[1, null]], "System Prompts": [[14, "system-prompts"]], "TarNet": [[0, "tarnet"], [2, null]], "TarNetBase": [[3, null]], "TarNetHyperparameterTuner": [[4, null]], "TarNet_loss": [[5, null]], "Text-As-Treatment": [[22, null]], "Visualizing Propensity Scores": [[22, "visualizing-propensity-scores"]], "What if you do not have GPU?": [[21, "what-if-you-do-not-have-gpu"]], "What is Text-As-Treatment?": [[22, "what-is-text-as-treatment"]], "What\u2019s GPI?": [[16, null]], "What\u2019s GPU?": [[21, "what-s-gpu"]], "When LLM is too big": [[20, null]], "dml_score": [[6, null]], "estimate_k_ate": [[7, null]], "estimate_psi_split": [[8, null]], "extract_and_save_hiddens": [[9, null]], "fit": [[1, "fit"], [2, "fit"]], "generate_text": [[10, null]], "get_instruction": [[11, null]], "load_hiddens": [[12, null]], "predict": [[1, "predict"], [2, "predict"]], "predict_proba": [[1, "predict-proba"]], "save_generated_texts": [[13, null]]}, "docnames": ["custom_imp", "f_SpectralNormClassifier", "f_TarNet", "f_TarNetBase", "f_TarNetHyperparameterTuner", "f_TarNet_loss", "f_dml_score", "f_estimate_k_ate", "f_estimate_psi_split", "f_extract_and_save_hiddens", "f_generate_text", "f_get_instructions", "f_load_hiddens", "f_save_generated_texts", "gen_llama", "gen_llm", "gpi", "hyperparameter", "index", "installation", "quantization", "startgpu", "tarnet"], "envversion": {"sphinx": 62, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["custom_imp.rst", "f_SpectralNormClassifier.rst", "f_TarNet.rst", "f_TarNetBase.rst", "f_TarNetHyperparameterTuner.rst", "f_TarNet_loss.rst", "f_dml_score.rst", "f_estimate_k_ate.rst", "f_estimate_psi_split.rst", "f_extract_and_save_hiddens.rst", "f_generate_text.rst", "f_get_instructions.rst", "f_load_hiddens.rst", "f_save_generated_texts.rst", "gen_llama.rst", "gen_llm.rst", "gpi.rst", "hyperparameter.rst", "index.rst", "installation.rst", "quantization.rst", "startgpu.rst", "tarnet.rst"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [10, 11, 18], "0": [0, 1, 2, 3, 4, 5, 7, 8, 15, 17, 18, 22], "001": 0, "00903": 16, "01": [2, 7, 8, 18, 22], "03": 18, "1": [0, 1, 2, 3, 4, 5, 7, 9, 12, 13, 14, 15, 17, 18, 20, 22], "10": [4, 17], "100": [0, 2, 4, 7, 17, 22], "1000": [9, 14], "1024": [2, 4, 17], "128": [1, 17], "1e": [1, 2, 4, 17], "2": [1, 2, 4, 7, 10, 12, 13, 15, 17, 22], "20": [1, 4, 17], "200": [0, 2, 3, 4, 7, 17, 22], "2024": 16, "2025": 18, "2048": [2, 3, 4, 7, 17, 22], "2410": 16, "256": 17, "2b": 15, "2e": [1, 2, 7, 22], "3": [2, 3, 9, 12, 14, 19, 20, 22], "32": [0, 1, 2, 7, 22], "4": [1, 2, 4, 17, 20], "4096": [4, 15, 17], "5": [0, 1, 2, 4, 7, 17, 22], "50": [2, 10], "512": [0, 15], "6": 1, "64": [1, 4, 17], "7": [19, 22], "8": 14, "8b": [9, 14, 20], "95": 22, "96": 22, "99": [7, 8, 22], "A": [5, 10, 12, 22], "ATE": [0, 6, 7, 22], "As": [16, 18], "By": 22, "For": [0, 5, 7, 11, 14, 15, 16, 17, 22], "If": [1, 2, 3, 7, 14, 17, 18, 21, 22], "In": [0, 10, 15, 17, 20, 21, 22], "It": [1, 2, 3, 4, 6, 8, 9, 10, 14, 15, 18, 20], "Its": 1, "One": 22, "The": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22], "Then": 21, "There": 22, "These": [17, 21], "To": [14, 17, 20, 21, 22], "a100": 21, "about": 14, "acceler": [19, 21], "access": [14, 16], "account": 21, "accur": 22, "achiev": 22, "across": 16, "act": 16, "activ": 3, "actual": 16, "adam": 1, "add": [1, 12], "add_generation_prompt": 15, "addit": [2, 7, 9, 10, 16, 22], "address": 22, "after": [1, 3], "ai": 14, "al": 15, "all": [2, 8, 10, 15, 20, 22], "allow": [14, 18], "along": [6, 13, 22], "alreadi": 22, "also": [1, 2, 10, 14, 15, 19, 22], "alwai": [10, 11, 14, 15], "amazon": 21, "american": [9, 14, 15, 22], "an": [0, 9, 11, 14, 15, 16, 17, 20, 22], "analys": 18, "analysi": [13, 18], "ani": [0, 10, 11, 18], "anyth": 21, "append": 15, "appli": [1, 3, 22], "applic": [16, 22], "apply_chat_templ": 15, "ar": [3, 5, 7, 8, 9, 10, 11, 12, 14, 15, 17, 22], "architectur": [0, 1, 3, 4, 7, 17, 22], "architecture_i": [0, 2, 4, 7, 17, 22], "architecture_z": [0, 2, 4, 7, 17, 22], "argument": [1, 2, 18, 22], "around": 17, "arrai": [1, 22], "artifici": [16, 18, 22], "arxiv": 16, "assign": [6, 16, 22], "associ": 9, "assum": [12, 22], "assumpt": [15, 22], "ate": [0, 7, 22], "ate_est": 7, "attention_mask": 15, "auto": [9, 14, 15, 20], "autom": 18, "automat": 1, "automodelforcausallm": [9, 10, 14, 15, 20], "autotoken": [9, 10, 14, 15, 20], "avail": [14, 21], "averag": [0, 6, 7], "avoid": 22, "awai": 10, "axi": 22, "bag": 16, "base": [0, 1, 4, 9, 11, 13, 15, 18, 22], "batch": [0, 1, 2, 3, 4, 7, 15, 17, 22], "batch_norm": 1, "batch_siz": [0, 1, 2, 4, 7, 22], "becaus": [0, 15, 16], "becom": 0, "been": 18, "befor": [0, 2, 17], "behavior": 11, "below": [0, 14, 15, 20, 21, 22], "best": [4, 14, 17, 22], "best_param": [4, 17], "between": 22, "bfloat16": [15, 20], "big": 18, "billion": 14, "binari": [1, 22], "biographi": [9, 14, 15, 22], "bit": 20, "bitsandbyt": 20, "bitsandbytesconfig": 20, "bn": [2, 3, 4, 7, 17, 22], "bnb_4bit_compute_dtyp": 20, "bnb_4bit_quant_typ": 20, "bnb_4bit_use_double_qu": 20, "bool": [1, 2, 3, 4, 7, 8, 22], "both": [0, 3, 8], "bound": [7, 8, 22], "brown": [9, 14, 15, 22], "build": [7, 22], "built": 21, "button": [14, 21], "c": [7, 9, 14, 15, 22], "c_mat": 22, "calcul": [5, 22], "call": [0, 16, 17, 22], "can": [0, 1, 14, 15, 16, 17, 19, 20, 21, 22], "cannot": 14, "case": [20, 21, 22], "categor": 5, "causal": [0, 10, 16, 22], "cd": 19, "challeng": 22, "chang": [15, 17, 21], "check": [20, 21, 22], "checkpoint": [2, 7, 9, 14, 15, 20, 22], "choos": 14, "chosen": [9, 10], "ci": 22, "circumv": 16, "class": [0, 1, 2, 3, 4, 5, 8, 17], "classif": 1, "classifi": [1, 22], "click": [14, 21], "clone": 19, "cloud": 21, "code": [14, 15, 16, 21, 22], "colab": 21, "colaboratori": 18, "column": 22, "column_stack": 22, "com": 19, "combin": [5, 6, 8], "command": [17, 20, 21], "comment": 16, "compat": 15, "complex": 16, "complic": 0, "compon": 0, "comput": [1, 3, 5, 6, 7, 8, 10, 14, 20, 21], "computation": 22, "concaten": 22, "condit": 22, "conf1": [7, 22], "conf2": [7, 22], "confid": 22, "configur": [4, 9, 10, 14], "confound": [7, 16, 18], "connect": 21, "consist": [0, 3, 16], "consol": 22, "constant": 1, "construct": [7, 22], "contain": [1, 12, 16, 22], "content": [15, 21], "context": 14, "contibut": 16, "continu": [0, 5, 22], "contribut": 18, "control": [0, 1, 2, 3, 5, 6, 8, 16, 18], "core": 3, "correspond": [4, 11, 13, 14, 15, 17, 22], "covari": 22, "cpu": [10, 12, 15], "creat": [9, 11, 15, 18, 21, 22], "create_studi": [4, 17], "creation": 11, "cross": [0, 7, 8, 22], "cuda": [10, 20, 21], "current": 18, "curv": 2, "custom": [3, 11, 18, 22], "d_c": 22, "d_r": 22, "data": [0, 1, 2, 3, 4, 7, 8, 14, 15, 17, 22], "datafram": [7, 22], "dataset": [1, 21], "decai": 1, "decod": [14, 15], "deconfoudn": [17, 22], "deconfound": [0, 1, 2, 3, 4, 8, 17, 22], "deconfounder_test": 1, "deconfounder_train": 1, "deep": [16, 21], "default": [1, 2, 3, 4, 7, 8, 9, 10, 12, 14, 22], "defin": [15, 17], "depend": [1, 5, 15], "describ": 14, "descript": [17, 18], "design": [10, 14, 15, 16, 17, 18, 21, 22], "desktop": 21, "detail": [14, 22], "determin": [3, 4], "determinist": [14, 15], "develop": [14, 15], "devic": [10, 12, 15], "device_map": [9, 14, 15, 20], "devis": 22, "df": [4, 7, 17, 22], "diagnos": 22, "dict": [7, 8, 9, 10, 22], "dictionari": [9, 10], "differ": [1, 4, 14], "difficult": 16, "dim": 15, "dimens": [1, 4, 17, 22], "dimension": 16, "dir": [9, 14], "direct": [4, 17, 22], "directli": [16, 19, 21, 22], "directori": [2, 7, 9, 10, 12, 14, 15, 22], "disciplin": 16, "disentangl": 22, "disk": [9, 12], "distribut": [0, 7, 8, 22], "dmatrix": 22, "dml_score": 18, "do": [14, 16, 17, 18, 22], "do_sampl": 15, "document": 20, "doe": [9, 13, 14, 15, 20, 21, 22], "doubl": [0, 20, 22], "doubli": 6, "downstream": 22, "draw": [4, 17], "drive": 21, "driver": 21, "dropout": [0, 1, 2, 3, 4, 7, 17, 22], "dure": [1, 2, 11, 17, 22], "e": [1, 4, 10, 19, 21, 22], "each": [0, 1, 3, 6, 7, 8, 10, 12, 15, 22], "earli": [1, 2, 7, 22], "easi": [17, 18, 21], "easiest": 19, "effect": [0, 2, 3, 6, 7, 14, 15, 16, 18], "effici": [14, 15, 22], "either": [4, 5, 17, 22], "els": 10, "email": 16, "empti": [9, 10], "enabl": [3, 21], "encount": [14, 20], "enough": [20, 22], "ensur": [15, 22], "entangl": 22, "entir": [0, 15, 16], "enumer": 15, "environ": 21, "eos_token_id": 15, "epoch": [0, 1, 2, 4, 7, 17, 22], "error": [0, 5, 7, 14, 16, 20], "especi": 21, "essenti": [16, 21], "estim": [2, 3, 6, 7, 8, 16, 18], "estimate_k_": [0, 18, 22], "estimate_psi_split": [0, 18], "etc": 12, "evalu": 2, "exampl": [0, 14, 16, 17, 18, 20, 22], "exist": [14, 17], "expect": 11, "explain": [0, 14], "explor": 4, "extens": [9, 12, 13], "extract": [2, 9, 10, 14, 15, 16, 21, 22], "extract_and_save_hidden": 18, "extract_and_save_hidden_st": [9, 14, 15], "extrem": 22, "f": [15, 22], "factor": 1, "fals": [1, 2, 3, 4, 7, 8, 15, 17, 21, 22], "far": 10, "favorit": 15, "featru": 22, "featur": [1, 16, 22], "feed": 1, "feedback": [16, 18], "feel": 18, "figur": 22, "file": [9, 12, 13, 14, 15, 22], "filenam": [9, 10, 13], "final": [8, 10, 22], "find": 21, "fine": 17, "first": [14, 15, 18, 22], "firstli": [15, 22], "fit": [0, 7, 8, 14, 22], "flag": 3, "flatten": 15, "flexibl": [0, 17, 18], "float": [1, 2, 3, 4, 7, 22], "float16": [9, 14], "fold": [7, 8, 22], "follow": [0, 14, 15, 16, 17, 20, 21, 22], "formula": [7, 22], "formula_c": [7, 22], "forward": [1, 3], "fr": [0, 2, 8], "fraction": [2, 4, 7], "frame": 22, "framework": [4, 17, 21], "free": [18, 21], "friendli": [16, 18], "from": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 21, 22], "from_pretrain": [9, 10, 14, 15, 20], "function": [0, 2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 22], "further": 13, "g": [1, 4, 10, 21, 22], "galaxi": 10, "gamma": 1, "gate": 14, "gemma": 15, "gemma2": 18, "gener": [3, 6, 9, 10, 11, 13, 20, 22], "generate_text": 18, "generated_text": [10, 13, 15], "get": 14, "get_instruct": [10, 18], "gilchrist": [9, 14, 15, 22], "git": 19, "github": [16, 19], "give": [15, 16], "given": [0, 1, 11, 12, 16], "go": 21, "googl": [15, 18], "gpi": [0, 14, 15, 17, 22], "gpi_pack": [0, 1, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 21, 22], "gpt": 10, "gpt2": 10, "gpu": [14, 15, 18, 20], "graph": 22, "graphic": 21, "greedi": 14, "group": [2, 3, 5, 8], "guarante": 15, "guid": 11, "ha": [14, 15, 21, 22], "half": [0, 8], "halv": [0, 8], "handl": [0, 22], "hard": [1, 18], "hardwar": 21, "have": [0, 14, 15, 17, 18, 20, 22], "head": 22, "here": [14, 20, 22], "hidden": [1, 3, 4, 7, 9, 10, 12, 14, 15, 17, 21, 22], "hidden_": [9, 10, 14], "hidden_al": 15, "hidden_dir": 22, "hidden_last_": [12, 22], "hidden_last_1": [12, 22], "hidden_last_2": 12, "hidden_list": [12, 22], "hidden_s": 1, "hidden_st": [0, 4, 10, 12, 15, 17, 22], "high": [9, 16], "highest": 1, "how": [0, 15, 17, 18, 20], "howev": 16, "http": 19, "huggingfac": [9, 14, 15, 20], "hyperparamet": [0, 4, 7, 8, 18], "i": [0, 1, 2, 3, 4, 7, 9, 11, 13, 14, 15, 16, 17, 18, 19, 21], "identifi": 12, "imag": 16, "imai": 16, "impact": 17, "implement": [0, 1, 3, 16, 22], "import": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 20, 21, 22], "improv": [1, 2, 7, 17, 22], "includ": [1, 10, 11, 16, 22], "independ": 15, "index": [15, 22], "indic": [2, 5, 6, 7, 8, 22], "infer": 21, "influenc": [6, 7, 8, 22], "inform": [2, 22], "initi": [0, 1, 3], "input": [0, 1, 3, 4, 10, 11, 14, 15, 17, 22], "input_dim": [1, 22], "input_id": 15, "instal": [17, 18, 20, 21], "instead": 22, "instruct": [9, 10, 11, 14, 15, 20, 21], "int": [1, 2, 4, 7, 9, 10, 22], "integr": 2, "intellig": [16, 18, 22], "intercept": 22, "interest": [16, 22], "interfac": [9, 17, 22], "intermedi": [4, 17, 22], "intern": [0, 2, 4, 14, 15, 16, 18, 22], "interpret": [1, 11], "interv": 22, "intial": 0, "introduc": 17, "invalid": 15, "is_avail": [10, 21], "issu": 16, "item": [5, 15], "iter": 1, "its": [7, 14, 15, 16], "jane": [9, 14, 15, 22], "john": [9, 14, 15, 22], "johnson": [9, 14, 15, 22], "just": 21, "k": [7, 15, 19, 22], "kei": [0, 22], "kentaro": 16, "know": 16, "kosuk": 16, "label": 1, "languag": [7, 9, 10, 11, 14, 15], "laptop": 21, "larg": [14, 15, 21, 22], "last": [4, 9, 10, 14, 15, 17, 22], "latent": [2, 3], "later": 13, "layer": [1, 2, 3, 4, 15, 17, 22], "learn": [0, 1, 2, 4, 7, 16, 17, 19, 21, 22], "learning_r": [0, 2, 4, 17], "len": 0, "level": [9, 14], "leverag": [4, 16], "librari": 18, "like": [12, 16, 21, 22], "likelihood": 5, "linear": [1, 3], "lipschitz": [0, 1], "lipshitz": 22, "list": [1, 2, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 22], "llama": [9, 14, 20], "llama3": [9, 15, 18, 20, 22], "llm": [0, 9, 10, 11, 13, 14, 18, 21, 22], "load": [2, 4, 9, 10, 12, 14, 15, 17, 20, 22], "load_hidden": [18, 22], "load_in_4bit": 20, "local": 21, "locat": 15, "log": [5, 14], "logit": 1, "loop": 15, "loss": [1, 2, 4, 5], "low": 16, "lower": [7, 8], "lower_bound": 22, "lr": [1, 7, 22], "machin": [0, 21, 22], "mai": [0, 15], "maintain": [16, 18], "make": 18, "mani": [16, 21, 22], "manner": 16, "mari": [9, 14, 15, 22], "matplotlib": 19, "matrix": 22, "max": 14, "max_new_token": [9, 10, 14, 15], "maximum": [1, 4, 9, 10, 14, 15], "mean": [0, 4, 5, 7, 9, 10, 14, 15, 17, 20, 22], "memori": 20, "messag": [7, 15, 20], "meta": [9, 14, 20], "method": [14, 16, 17, 18, 22], "might": [16, 22], "min_delta": [1, 2, 7, 22], "minim": [4, 17], "minimum": [1, 2, 4, 7, 22], "mlp": 1, "model": [1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 21, 22], "model_checkpoint": 2, "model_config": [9, 10, 14], "model_dir": [2, 7, 22], "model_select": 0, "modul": 22, "more": [0, 14, 22], "most": 22, "mount": 21, "multi": 1, "must": [14, 21, 22], "n": 22, "n_power_iter": 1, "n_sampl": 1, "n_trial": [4, 17], "nakam": 19, "nakamura": 16, "name": [9, 12, 13, 14, 15, 17, 22], "nathaniel": [9, 14, 15, 22], "natur": [14, 15, 16], "ndarrai": [1, 2, 6, 7, 8, 22], "nearest": 22, "necessari": 15, "need": [0, 14, 15, 16, 17, 20, 21, 22], "neg": 5, "nepoch": [1, 7, 22], "network": [0, 1, 3, 22], "neural": [0, 1, 3, 22], "new": [9, 14, 21], "nf4": 20, "nice": 0, "none": [2, 3, 9, 12, 13, 15], "norm": 1, "normal": [0, 1, 2, 3, 4, 7, 17, 22], "note": 0, "notebook": 21, "now": 21, "np": [1, 2, 6, 7, 8, 22], "num_class": 1, "number": [0, 1, 2, 4, 7, 9, 10, 14, 15, 17, 22], "numpi": [0, 19, 22], "nvidia": 21, "obj": [4, 17], "object": [4, 16, 17, 22], "observ": [0, 6, 8, 22], "obtain": [0, 10], "offer": 0, "often": [10, 16, 20], "onc": [0, 10, 14, 20, 22], "one": [0, 3, 14, 16, 17, 22], "ones": 17, "onli": [18, 22], "onto": 15, "open": [14, 15], "optim": [1, 2, 4, 17], "option": [1, 2, 3, 4, 7, 8, 9, 10, 12, 14, 15, 17, 22], "optuna": [4, 17], "order": 1, "other": [0, 9, 10, 11, 16, 18, 22], "otherwis": [3, 14], "our": [0, 17, 18, 22], "out": [18, 20], "outcom": [0, 2, 3, 4, 5, 6, 7, 8, 17, 22], "outcomevar": [4, 7, 17, 22], "output": [1, 2, 3, 4, 10, 11, 13, 15, 17, 21, 22], "output_hidden_dir": [9, 14], "output_hidden_st": 15, "outsid": 22, "over": 1, "overlap": 16, "overview": [16, 22], "own": 14, "pack": [0, 14, 17, 22], "packag": [14, 15, 16, 18, 19, 20, 22], "pad": 15, "pad_token_id": 15, "panda": [7, 19, 22], "paper": [16, 18, 22], "paramet": [14, 17, 18, 20, 22], "part": 22, "particip": [16, 22], "pass": [1, 3, 4, 17, 22], "path": [9, 10, 14, 22], "patienc": [1, 2, 4, 7, 17, 22], "patience_max": [4, 17], "patience_min": [4, 17], "patsi": [7, 19, 22], "pd": [7, 22], "perceptron": 1, "perform": [1, 2, 11, 17, 18], "person": 14, "pick": [15, 17], "pickl": [9, 13], "pip": [17, 19, 20, 21], "pkl": 13, "pleas": [0, 17, 18, 22], "plot": [0, 2, 7, 8, 22], "plot_loss": 2, "plot_propens": [0, 7, 8, 22], "politician": [9, 14, 15, 22], "pool": [9, 10, 14], "popular": 21, "posit": 16, "possibl": 18, "power": 1, "practition": 16, "precis": 20, "predict": [0, 3, 5, 6, 7, 8, 22], "prefix": [9, 10, 12, 14, 22], "prefix_hidden": [9, 10, 14, 15], "preprint": 16, "pretrain": [9, 14, 15, 20], "previou": 15, "print": [1, 2, 4, 5, 6, 7, 10, 11, 12, 17, 21, 22], "prob": 1, "probabl": [0, 1, 2, 3, 6], "problem": 16, "procedur": [0, 16, 22], "process": [0, 2, 10, 14, 15, 21], "produc": [10, 11, 14, 15], "profil": 14, "progress": 7, "prompt": [9, 10, 11, 13, 15, 18], "propens": [7, 8, 18], "properti": 0, "proport": [1, 22], "propos": 22, "provid": [0, 1, 3, 9, 11, 14, 16, 17, 18, 21, 22], "ps_model": [0, 7, 8, 22], "ps_model_param": [7, 8, 22], "ps_pred": 0, "psi": [0, 6, 7, 8], "pt": [12, 15, 22], "purpos": [16, 18], "pypi": 18, "python": [16, 18, 19, 21], "pytorch": 21, "quantil": 8, "quantiz": 18, "quantization_config": 20, "r": [0, 2, 4, 7, 17, 22], "r_test": 0, "r_train": 0, "rais": [9, 10], "rand": 7, "random": 7, "randomli": 16, "rang": [1, 4, 14, 15, 17, 18, 22], "rate": [0, 1, 2, 3, 4, 7, 17, 22], "rather": 15, "raw": 3, "reach": 18, "read": 12, "reason": [0, 22], "receiv": 0, "recommend": [14, 15, 17, 22], "reduc": 20, "reducelronplateau": 1, "refer": [0, 22], "relationship": 22, "releas": 18, "remov": 22, "repeat": [0, 11, 18], "replac": 22, "repo": 14, "report": 16, "repres": 5, "represent": [0, 2, 3, 4, 7, 9, 12, 14, 15, 16, 17, 18, 22], "representaiton": 16, "request": 14, "requir": [1, 14, 15, 16, 18, 20, 22], "research": 16, "reset": 1, "resourc": 14, "respons": 15, "result": [16, 22], "retriev": 13, "return": [1, 2, 3, 18], "return_dict": 15, "return_dict_in_gener": 15, "return_prob": [3, 5], "return_probabl": 2, "return_tensor": 15, "robert": [9, 14, 15, 22], "robust": 6, "role": 15, "run": [4, 17, 21], "runtim": 21, "sagemak": 21, "sampl": [0, 1, 2, 6, 8, 22], "save": [2, 7, 9, 10, 13, 14, 15, 22], "save_generated_text": 18, "save_hidden": [10, 15], "save_nam": [9, 13, 14], "scalar": 5, "scenario": 3, "schedul": [1, 2, 7, 17, 22], "scheduler_typ": 1, "scikit": 19, "scipi": 19, "score": [6, 7, 8, 18], "se": [0, 7, 22], "se_est": 7, "second": 22, "section": [0, 14, 15, 16, 17, 22], "see": [14, 15, 20], "seek": [4, 17], "select": [1, 14, 21], "sentiment": 22, "separ": 22, "sequenc": 15, "servic": 21, "set": [0, 1, 3, 4, 9, 14, 17, 18, 22], "shape": [1, 12, 15, 22], "share": [0, 2, 3, 7, 22], "show": [0, 15, 20, 21, 22], "shown": 0, "sign": 21, "signific": 17, "significantli": [20, 21], "simpl": 17, "simpli": 11, "simultan": 0, "size": [0, 1, 2, 3, 4, 7, 14, 17, 20, 22], "sizes_i": 3, "sizes_z": 3, "skip_special_token": 15, "sklearn": 0, "smith": [9, 14, 15, 22], "so": [14, 16], "softmax": [1, 3], "some": [15, 22], "sometim": [15, 16, 22], "sourc": [14, 15, 18], "special": [14, 21], "specif": [0, 2, 11, 16, 22], "specifi": [1, 9, 10, 14, 15, 20, 22], "spectral": [0, 1, 22], "spectralnormclassifi": [0, 7, 8, 18], "speed": 21, "split": [0, 1, 2, 7, 8, 22], "sqrt": 0, "squar": 5, "stabil": 1, "stack": [12, 15], "standard": [0, 7], "state": [4, 7, 9, 10, 12, 14, 15, 17, 21, 22], "statist": [16, 18, 21], "std": 0, "step": [0, 1, 2, 4, 7, 15, 16, 17, 22], "step_siz": [1, 2, 4, 7, 17, 22], "steplr": 1, "stop": [1, 2, 7, 17, 22], "store": [12, 22], "str": [1, 2, 4, 7, 9, 10, 11, 12, 13, 22], "strategi": [9, 10, 14], "string": [4, 9, 11, 14], "studi": [4, 17], "style": [7, 22], "suggest": [10, 11, 15, 16, 18], "suppli": [14, 22], "support": [2, 3, 18, 20, 21], "suppos": [14, 15, 22], "survei": 16, "system": [15, 18], "t": [0, 1, 2, 4, 6, 7, 8, 17, 22], "t4gpu": 21, "t_test": 0, "t_train": [0, 1], "t_true": 5, "take": [0, 9], "target": 1, "tarnet": [4, 5, 7, 17, 18, 22], "tarnet_loss": 18, "tarnetbas": [2, 18], "tarnethyperparametertun": [17, 18], "task": [9, 11, 14, 15], "task_typ": [9, 11, 14], "technic": 22, "techniqu": [20, 22], "tell": 11, "temperatur": 15, "tensor": [2, 5, 6, 8, 12], "test": [0, 7], "test_siz": 0, "text": [9, 10, 11, 13, 16, 18, 20], "textual": 22, "than": [0, 15], "them": [12, 16, 21, 22], "theoret": 22, "therefor": 22, "thi": [0, 1, 11, 13, 14, 15, 16, 17, 18, 20, 21, 22], "three": 0, "threshold": [2, 22], "thu": 16, "time": 10, "tnutil": [0, 1, 3, 5, 6, 8, 12], "togeth": 12, "token": [9, 10, 14, 15, 20], "tokenizer_config": [9, 10, 14], "tolist": 22, "too": 18, "tool": 18, "toolkit": 21, "top_p": 15, "topic": 22, "torch": [2, 5, 6, 8, 9, 10, 12, 14, 15, 19, 20, 21], "torch_dtyp": [9, 14, 15], "tpred": [6, 8], "tqdm": 19, "tradition": 16, "train": [0, 1, 2, 7, 8, 17, 22], "train_test_split": 0, "transform": [9, 10, 14, 15, 19, 20], "treat": [2, 3, 5, 6, 8, 11], "treatment": [0, 2, 3, 4, 5, 6, 7, 8, 16, 18], "treatmentvar": [4, 7, 17, 22], "trial": [4, 17], "trim": [7, 8, 22], "true": [0, 2, 3, 4, 5, 7, 8, 15, 17, 20, 21, 22], "try": [4, 16, 17], "tune": [4, 14, 18], "tuner": 17, "tupl": 3, "two": [0, 3, 8, 16, 22], "type": [1, 9, 11, 14, 20, 21], "typic": 22, "under": [0, 6, 22], "uniformli": 17, "unit": [21, 22], "unstructur": 16, "untreat": [3, 6], "up": [15, 17, 21], "upon": [10, 21], "upper": [7, 8], "upper_bound": 22, "url": 14, "us": [0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 18, 20, 22], "usag": 18, "use_schedul": 1, "user": [11, 14, 15, 16, 18, 22], "util": 18, "valid": [1, 2, 4, 7, 22], "valid_perc": [1, 2, 4, 7, 22], "valu": [1, 2, 4, 5, 7, 8, 9, 10, 11, 13, 17, 22], "valueerror": [9, 10], "variabl": [0, 4, 16, 22], "variou": 15, "verbos": [2, 7, 22], "version": [14, 18], "via": [3, 10, 19, 22], "view": 15, "violat": [16, 22], "virtual": 21, "visual": 18, "wai": [19, 21, 22], "wait": 17, "want": [9, 14, 15, 17, 22], "we": [0, 14, 15, 16, 17, 18, 20, 22], "webpag": 14, "websit": [14, 21], "welcom": 16, "well": 2, "what": 18, "when": [1, 13, 14, 18, 22], "where": [9, 10, 12, 15, 16, 22], "whether": [0, 1, 2, 3, 5, 7, 8, 22], "which": [0, 12, 14, 15, 16, 20, 21, 22], "while": [0, 15, 22], "who": [10, 11, 14, 15], "wide": [14, 15, 18], "wihtout": 0, "wish": 16, "without": [9, 12, 13, 16, 21, 22], "work": [1, 15, 18], "workflow": [16, 18], "would": 21, "wrapper": [0, 2, 17, 22], "write": 21, "x": [0, 1], "y": [0, 1, 2, 4, 6, 7, 8, 17, 22], "y0": [0, 2, 8], "y0_pred": [0, 2, 5, 8], "y1": [0, 2, 8], "y1_pred": [0, 2, 5, 8], "y_test": 0, "y_train": 0, "y_true": 5, "you": [0, 9, 10, 11, 14, 15, 16, 17, 18, 19, 20, 22], "your": [9, 14, 15, 16, 18, 20, 21, 22], "ypred0": 6, "ypred1": 6}, "titles": ["Customizing Your Analysis", "SpectralNormClassifier", "TarNet", "TarNetBase", "TarNetHyperparameterTuner", "TarNet_loss", "dml_score", "estimate_k_ate", "estimate_psi_split", "extract_and_save_hiddens", "generate_text", "get_instruction", "load_hiddens", "save_generated_texts", "Generating Texts with LLaMa3", "Generating Texts with Other LLMs", "What\u2019s GPI?", "Hyperparameter Tuning", "GPI: Generative-AI Powered Inference", "Installation", "When LLM is too big", "How to use GPU", "Text-As-Treatment"], "titleterms": {"": [16, 21], "As": 22, "advanc": 18, "ai": [16, 18], "analysi": 0, "argument": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "autom": 17, "basic": 18, "big": 20, "colaboratori": 21, "confound": 22, "contribut": 16, "control": 22, "creat": 14, "custom": 0, "data": 18, "descript": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "dml_score": 6, "do": 21, "effect": 22, "estim": [0, 22], "estimate_k_": 7, "estimate_psi_split": 8, "exampl": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15], "extract_and_save_hidden": 9, "fit": [1, 2], "from": 19, "gemma2": 15, "gener": [14, 15, 16, 18], "generate_text": 10, "get": 18, "get_instruct": 11, "googl": 21, "gpi": [16, 18], "gpu": 21, "have": 21, "how": [14, 21, 22], "hyperparamet": [17, 22], "i": [20, 22], "infer": [16, 18], "instal": 19, "list": 17, "llama3": 14, "llm": [15, 20], "load_hidden": 12, "method": [1, 2], "model": [0, 20], "oper": 18, "other": 15, "paramet": [1, 2, 3], "power": [16, 18], "predict": [1, 2], "predict_proba": 1, "prompt": 14, "propens": [0, 22], "purpos": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "pypi": 19, "quantiz": 20, "refer": [16, 18], "repeat": 14, "requir": 19, "return": [5, 6, 7, 8, 9, 10, 11, 12, 13], "save_generated_text": 13, "score": [0, 22], "sourc": 19, "spectralnormclassifi": 1, "start": 18, "system": 14, "tarnet": [0, 2], "tarnet_loss": 5, "tarnetbas": 3, "tarnethyperparametertun": 4, "text": [14, 15, 22], "too": 20, "treatment": 22, "tune": 17, "us": [14, 21], "usag": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "visual": 22, "what": [16, 21, 22], "when": 20, "workflow": 0, "you": 21, "your": 0}})